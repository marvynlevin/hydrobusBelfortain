{% extends 'layout.html' %}

{% block title %}
    <title>Etat réservoirs | HydroBus</title>
{% endblock %}

{% block body %}
<main>
    <div class="row_flex page_formatter">
        <div class="big_docker models_list width_70">
            <h2>Liste des contrôles</h2>

            <div class=" list_container">
                <div class="list">
                    {% for controle in controles %}
                    <details class="card drop_shadow">
                            <summary>
                                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="34" viewBox="0 0 35 34" fill="none">
                                    <path d="M17.1088 2H8.04354C5.92811 2 4.87038 2 4.0624 2.36332C3.35166 2.68288 2.77382 3.19282 2.4117 3.82003C2 4.53307 2 5.4665 2 7.33333V26.6667C2 28.5335 2 29.467 2.4117 30.18C2.77382 30.8072 3.35166 31.3172 4.0624 31.6367C4.87038 32 5.92811 32 8.04354 32H11.443M17.1088 2L28.4405 12M17.1088 2V9.33333C17.1088 10.2667 17.1088 10.7335 17.3147 11.09C17.4958 11.4036 17.7846 11.6586 18.14 11.8184C18.544 12 19.0728 12 20.1306 12H28.4405M28.4405 12V13.6667M18.9975 32L22.8219 31.325C23.1552 31.2662 23.322 31.2367 23.4774 31.1828C23.6155 31.1352 23.7467 31.0732 23.8682 30.9983C24.0053 30.914 24.1254 30.808 24.366 30.5957L32.2177 23.6667C33.2608 22.7462 33.2608 21.2538 32.2177 20.3333C31.1746 19.4128 29.4836 19.4128 28.4405 20.3333L20.5888 27.2623C20.3482 27.4747 20.2281 27.5807 20.1325 27.7017C20.0477 27.8088 19.9775 27.9247 19.9234 28.0465C19.8624 28.1837 19.829 28.3308 19.7623 28.625L18.9975 32Z" stroke="#215D91" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <h3>Contrôle n°{{ controle["id_controle"]}} ({{ controle["date_controle"] }}) reservoir-{{ controle["modele_reservoir"] }}</h3>
                            </summary>
                            <div class="body">
                            <!-- On met le contenu ici -->
                            <div class="row_flex">
                                <div class="left">
                                <div class="info">
                                    <h4>Date :</h4>
                                    <p>{{ controle["date_controle"]}}</p>
                                </div>
                                <div class="info">
                                    <h4>Reservoir :</h4>
                                    <p>reservoir-{{ controle["modele_reservoir"] }}</p>
                                </div>
                                <div class="info">
                                    <h4>Prix :</h4>
                                    <p>{{ controle["prix"] }}€</p>
                                </div>
                            </div>
                            <div class="right i_love_you">
                                <div class="card_actions">
                                    <svg class="popup_delete" viewBox="0 0 21 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M17.625 4.66667L16.6739 19.3491C16.5907 20.635 16.549 21.278 16.2792 21.7656C16.0416 22.1948 15.6832 22.5398 15.2513 22.7553C14.7608 23 14.1346 23 12.8824 23H8.1176C6.86538 23 6.23927 23 5.74868 22.7553C5.31676 22.5398 4.9584 22.1948 4.72082 21.7656C4.45096 21.278 4.40931 20.635 4.32602 19.3491L3.375 4.66667M1 4.66667H20M15.25 4.66667L14.9287 3.67431C14.6172 2.71264 14.4614 2.2318 14.1726 1.87631C13.9175 1.56238 13.59 1.31939 13.22 1.16962C12.8009 1 12.3086 1 11.3236 1H9.67635C8.69144 1 8.1991 1 7.78004 1.16962C7.41003 1.31939 7.08247 1.56238 6.82741 1.87631C6.53856 2.2318 6.38284 2.71264 6.07139 3.67431L5.75 4.66667" stroke="#F44343" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                    <svg class="popup_edit" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M22.0795 5.9141L11.649 16.3628C10.6103 17.4033 7.52709 17.8852 6.83829 17.1952C6.14948 16.5051 6.61962 13.4165 7.65829 12.376L18.0997 1.91639C18.3572 1.63497 18.6689 1.40876 19.0162 1.25137C19.3633 1.09398 19.7388 1.00866 20.1198 1.00063C20.5007 0.992597 20.8794 1.06197 21.2329 1.20458C21.5864 1.3472 21.9074 1.56011 22.1765 1.83042C22.4455 2.10073 22.6572 2.42284 22.7986 2.77733C22.9399 3.13184 23.0083 3.51134 22.9992 3.89298C22.9901 4.27462 22.9039 4.6505 22.7459 4.99786C22.5878 5.34522 22.3611 5.65692 22.0795 5.9141Z" stroke="#2A7AC1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                        <path d="M10.8401 3.2854H5.37336C4.21347 3.2854 3.10116 3.74696 2.28099 4.56857C1.46083 5.39017 1 6.50449 1 7.66642V18.619C1 19.7809 1.46083 20.8952 2.28099 21.7168C3.10116 22.5384 4.21347 23 5.37336 23H17.4001C19.8164 23 20.6801 21.0285 20.6801 18.619V13.1427" stroke="#2A7AC1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                </div>
                            </div>
                            </div>
                            <div class="full">
                                <div class="info">
                                    <h4>Description:</h4>
                                    <p>{{ controle["analyse_rendue"]}}</p>
                                </div>
                            </div>
                        </div>
                        <div class="popup edit">
                            <div class="content">
                                <div class="popup_head">
                                    <h2>Modification d’un contrôle</h2>
                                    <div class="popup_close">
                                        <svg  viewBox="0 0 47 47" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M1.3006 1.30057C-0.433532 3.0347 -0.433532 5.84622 1.3006 7.58034L17.2202 23.5L1.3006 39.4198C-0.433532 41.1538 -0.433532 43.9655 1.3006 45.6996C3.03469 47.4335 5.84625 47.4335 7.58032 45.6996L23.5 29.7796L39.4198 45.6996C41.1539 47.4335 43.9656 47.4335 45.6995 45.6996C47.4335 43.9655 47.4335 41.1538 45.6995 39.4198L29.7796 23.5L45.6995 7.58039C47.4335 5.84631 47.4335 3.03474 45.6995 1.30065C43.9651 -0.433479 41.1539 -0.433479 39.4198 1.30065L23.5 17.2202L7.58032 1.30057C5.84625 -0.433522 3.03469 -0.433522 1.3006 1.30057Z" fill="black"></path>
                                        </svg>
                                    </div>
                                </div>
                                <p>controle n°{{ controle["id_controle"] }} ({{ controle["date_controle"] }})</p>
                               <form method="post" action="/controles/edit">
                                   <input id="id_controle" name="id_controle" type="text" value="{{ controle['id_controle'] }}" hidden="hidden">
                                    <div class="field row_flex">
                                        <label for="description_2">Compte rendu du contrôle</label>
                                        <textarea name="description_2" id="description_2" cols="30" rows="10"
                                                  class="compte_rendu_area">{{ controle["analyse_rendue"] }}</textarea>
                                    </div>
                                    <div class="field row_flex">
                                          <label for="date_controle_2">Date du contrôle</label>
                                          <input type="date" id="date_controle_2" name="date_controle_2" value="{{ controle["date_controle"] }}">
                                    </div>
                                    <div class="field row_flex">
                                        <label for="id_modele_reservoir">Modèle réservoir</label>
                                            <select class="form-select" id="id_modele_reservoir" name="id_modele_reservoir" required>
                                                <option selected disabled value="">Sélectionnez un modèle</option>
                                                {% for modele in modeles_reservoirs %}
                                                    {% if modele["id_modele_reservoir"] == controle["id_modele_reservoir"] %}
                                                        <option selected value="{{ modele['id_modele_reservoir'] }}">{{ modele['id_modele_reservoir'] }} - {{ modele["modele_reservoir"] }}</option>
                                                    {% else %}
                                                        <option value="{{ modele['id_modele_reservoir'] }}">{{ modele['id_modele_reservoir'] }} - {{ modele["modele_reservoir"] }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                    </div>
                                    <div class="field row_flex">
                                        <label for="prix_controle_2">Prix du contrôle</label>
                                        <input type="number" id="prix_controle_2" name="prix_controle_2" value="{{ controle["prix"] }}">
                                    </div>
                                    <button type="submit">Ajouter</button>
                               </form>
                            </div>
                        </div>
                        <div class="popup delete">
                            <div class="content">
                                <div class="popup_head">
                                    <h2>Supprimer un réservoir</h2>
                                    <div class="popup_close">
                                        <svg  viewBox="0 0 47 47" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M1.3006 1.30057C-0.433532 3.0347 -0.433532 5.84622 1.3006 7.58034L17.2202 23.5L1.3006 39.4198C-0.433532 41.1538 -0.433532 43.9655 1.3006 45.6996C3.03469 47.4335 5.84625 47.4335 7.58032 45.6996L23.5 29.7796L39.4198 45.6996C41.1539 47.4335 43.9656 47.4335 45.6995 45.6996C47.4335 43.9655 47.4335 41.1538 45.6995 39.4198L29.7796 23.5L45.6995 7.58039C47.4335 5.84631 47.4335 3.03474 45.6995 1.30065C43.9651 -0.433479 41.1539 -0.433479 39.4198 1.30065L23.5 17.2202L7.58032 1.30057C5.84625 -0.433522 3.03469 -0.433522 1.3006 1.30057Z" fill="black"></path>
                                        </svg>
                                    </div>
                                </div>
                                <p>Supprimer le contrôle n°{{controle["id_controle"]}}</p>

                                <div class="row_flex action_buttons">
                                    <button type="button" class="cancel">Annuler</button>
                                    <form action="/controles/delete" method="get">
                                        <input name="id_controle" type="text" value="{{ controle['id_controle'] }}" hidden="hidden">
                                        <button type="submit">Supprimer</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </details>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="big_docker no_border no_padding fix_height">
            <div class="column_flex">
                <div class="big_docker full_width child auto_horizontal_margin no_left_margin">
                    <h2>Ajouter un contrôle</h2>
                    <!-- Valeurs du formulaire à récupérer ! -->
                    <form method="post" id="add_controle" action="/controles/new">
                        <div class="field row_flex">
                            <label for="description_2">Compte rendu du contrôle</label>
                            <textarea maxlength="200" name="description_2" id="description_2" cols="30" rows="10"
                                      class="compte_rendu_area"></textarea>
                        </div>
                        <div class="field row_flex">
                              <label for="date_controle_2">Date du contrôle</label>
                              <input type="date" id="date_controle_2" name="date_controle_2">
                        </div>
                        <div class="field row_flex">
                            <label for="id_modele_reservoir">Modèle réservoir</label>
                             <select class="form-select" id="id_modele_reservoir" name="id_modele_reservoir" required>
                                      <option selected value="">Aucun modèle</option>
                                      {% for modele in modeles_reservoirs %}
                                          <option value="{{ modele['id_modele_reservoir'] }}">{{ modele["id_modele_reservoir"] }} - {{ modele["modele_reservoir"] }}</option>
                                      {% endfor %}
                             </select>
                        </div>
                        <div class="field row_flex">
                            <label for="prix_controle_2">Prix du contrôle</label>
                            <input type="number" id="prix_controle_2" name="prix_controle_2">
                        </div>
                        <div class="field row_flex">
                            <button>Ajouter</button>
                        </div>
                    </form>
                </div>
            </div>
            <div>
                <div class="big_docker full_width yeet_padding">
                    <h2>Rechercher un état</h2>
                    <p> Pour rechercher un état de contrôle, veuillez accéder à cette page</p>
                    <a class="button" href="/controles/etat">Etat contrôle</a>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

